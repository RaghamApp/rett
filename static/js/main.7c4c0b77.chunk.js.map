{"version":3,"sources":["query.ts","pages/Retention.tsx","components/Heatmap.tsx","pages/Summary.tsx","App.tsx","reportWebVitals.ts","index.tsx"],"names":["json","res","get","method","params","fetch","url","then","getGrowingUsers","page","getDecliningUsers","getTopUsers","getRetentionChart","theme","fontSize","stepColors","Retention","useQuery","isLoading","isError","data","base","chart","className","style","height","map","v","i","id","toString","value","foo","direction","margin","top","right","bottom","left","colors","labelColor","from","modifiers","borderColor","currentPartSizeExtension","currentBorderWidth","motionDamping","shapeBlending","spacing","nUsers","Heatmap","name","uid","tags","useState","open","setOpen","onClick","display","t","width","length","d","x","fillOpacity","data-level","Users","title","query","setPage","keepPreviousData","isPreviousData","u","heatmap","old","Summary","queryClient","QueryClient","App","QueryClientProvider","client","href","type","data-bs-toggle","data-bs-target","aria-controls","aria-expanded","aria-label","path","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.7c4c0b77.chunk.js","sourcesContent":["\nimport url from 'urlcat'\n\nconst json = (res: Response) => res.json()\n\nfunction get(method: string, params: Record<string, any>) {\n  return fetch(url(\"https://retta.rghm.ir/\" + method, params)).then(json)\n}\n\nexport const getGrowingUsers = (page: number) => get('getGrowingUsers', { page })\nexport const getDecliningUsers = (page: number) => get('getDecliningUsers', { page })\nexport const getTopUsers = (page: number) => get('getTopUsers', { page })\nexport const getRetentionChart = (): Promise<{ chart: number[], nUsers: number }> => get('getRetentionChart', null)\n","import { useQuery } from \"react-query\";\nimport { ResponsiveFunnel } from \"@nivo/funnel\";\n\nimport { getRetentionChart } from \"../query\";\nimport { Theme } from \"@nivo/core\";\n\nconst theme: Theme = {\n  fontSize: 20,\n};\n\nconst stepColors = ['#9dcef2', '#9dcef2', '#9dcef2', '#9dcef2', '#9dcef2',  '#9dcef2', '#42afff']\n\n\nfunction Retention() {\n  const { isLoading, isError, data } = useQuery(\n    \"getRetentionChart\",\n    getRetentionChart\n  );\n\n  if (isLoading) return <h3>Loading...</h3>;\n  if (isError) return <h3>An error has occurred</h3>;\n\n  const base = data.chart[0];\n\n  return (\n    <>\n      <h1 className=\"h1\">Retention</h1>\n      <h6 className=\"pb-3 border-bottom\">Last Month</h6>\n\n      <div className=\"pt-3 pb-3\" style={{ height: \"300px\" }}>\n        <ResponsiveFunnel\n          data={data.chart.map((v, i) => ({\n            id: i.toString(),\n            value: ~~((v / base) * 100),\n            foo: \"bar\",\n          }))}\n          direction=\"horizontal\"\n          margin={{ top: 0, right: 0, bottom: 0, left: 0 }}\n          colors={stepColors}\n          labelColor={{ from: 'color', modifiers: [ ['darker', 100] ] }}\n          borderColor=\"#000000\"\n          currentPartSizeExtension={5}\n          currentBorderWidth={50}\n          motionDamping={1}\n          shapeBlending={0}\n          spacing={5}\n          theme={theme}\n        />\n      </div>\n\n      <h6 className=\"fw-light\">{data.nUsers + \" total users in this period\"}</h6>\n    </>\n  );\n}\n\nexport default Retention;\n","import { ReactElement, useState } from \"react\";\nimport \"./Heatmap.css\";\n\ninterface Props {\n  uid: string;\n  name: string;\n  tags: string[];\n  data: number[];\n}\n\nconst className = (v: number) => `heatmap ${v === 0 ? \"disabled\" : \"\"}`;\nconst opacity = (v: number) => (v === 0 ? 1 : v / 10);\n\nfunction Heatmap({ data, name, uid, tags }: Props): ReactElement {\n  const [open, setOpen] = useState(false);\n\n  return (\n    <div\n      className=\"d-inline-flex justify-content-between w-100 mb-2\"\n      onClick={() => setOpen(!open)}\n    >\n      <div style={{ display: \"inline-block\" }}>\n        <span>{name}</span>\n        &nbsp;\n        {tags.map((t) => (\n          <span className=\"badge rounded-pill bg-info\">{t}</span>\n        ))}\n        {open && <h6 className=\"fw-lighter\">{uid}</h6>}\n      </div>\n\n      <svg width={data.length * 22} height=\"20\" className=\"heatmap\">\n        {data.map((d, i) => (\n          <rect\n            width=\"20\"\n            height=\"20\"\n            x={i * 22}\n            fillOpacity={opacity(d)}\n            data-level=\"0\"\n            className={className(d)}\n          >\n          </rect>\n        ))}\n      </svg>\n    </div>\n  );\n}\n\nexport default Heatmap;\n","import { useState } from \"react\";\nimport { useQuery } from \"react-query\";\nimport Heatmap from \"../components/Heatmap\";\nimport { getDecliningUsers, getGrowingUsers, getTopUsers } from \"../query\";\n\n\nfunction Users({ name, title, query }) {\n  const [page, setPage] = useState(0);\n  const { isLoading, isError, data, isPreviousData } = useQuery(\n    [name, page],\n    () => query(page),\n    {\n      keepPreviousData: true,\n    }\n  );\n\n  if (isLoading) return <h3>Loading...</h3>;\n  if (isError) return <h3>An error has occurred</h3>;\n\n  return (\n    <>\n      <h1 className=\"mb-3\">{title}</h1>\n      <div className=\"container\">\n        {data.map((u) => (\n          <div className=\"mb-1\">\n            <Heatmap data={u.heatmap} name={u.name} uid={u.id} tags={u.tags} />\n          </div>\n        ))}\n\n        <button\n          className=\"btn btn-outline-primary mb-3\"\n          onClick={() => {\n            if (!isPreviousData) setPage((old) => old + 1);\n          }}\n        >\n          More\n        </button>\n      </div>\n    </>\n  );\n}\n\nfunction Summary() {\n  return (\n    <>\n      <Users\n        name=\"getGrowingUsers\"\n        title=\"Users with the highest usage growth 📈 😋\"\n        query={getGrowingUsers}\n      />\n      <Users\n        name=\"getTopUsers\"\n        title=\"Top Stable Users ⚡️🔥\"\n        query={getTopUsers}\n      />\n      <Users\n        name=\"getDecliningUsers\"\n        title=\"Users whose usage is declining 📉😞\"\n        query={getDecliningUsers}\n      />\n    </>\n  );\n}\n\nexport default Summary;\n","import { QueryClient, QueryClientProvider } from \"react-query\";\nimport { BrowserRouter as Router, Route, Switch } from \"react-router-dom\";\nimport Retention from \"./pages/Retention\";\nimport Summary from \"./pages/Summary\";\n\nconst queryClient = new QueryClient();\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <Router>\n        <div className=\"App\">\n          <nav className=\"navbar navbar-expand-md navbar-dark bg-dark mb-5\">\n            <div className=\"container-fluid\">\n              <a className=\"navbar-brand\" href=\"/\">\n                Retta\n              </a>\n              <button\n                className=\"navbar-toggler\"\n                type=\"button\"\n                data-bs-toggle=\"collapse\"\n                data-bs-target=\"#navbarCollapse\"\n                aria-controls=\"navbarCollapse\"\n                aria-expanded=\"false\"\n                aria-label=\"Toggle navigation\"\n              >\n                <span className=\"navbar-toggler-icon\"></span>\n              </button>\n              <div className=\"collapse navbar-collapse\" id=\"navbarCollapse\">\n                <ul className=\"navbar-nav me-auto mb-2 mb-md-0\">\n                  <li className=\"nav-item\">\n                    <a className=\"nav-link\" href=\"/summary\">\n                      Summary\n                    </a>\n                  </li>\n                  <li className=\"nav-item\">\n                    <a className=\"nav-link\" href=\"/retention\">\n                      Retention\n                    </a>\n                  </li>\n                </ul>\n              </div>\n            </div>\n          </nav>\n\n          <div className=\"container\">\n            <Switch>\n              <Route path=\"/retention\">\n                <Retention />\n              </Route>\n              <Route path=\"/summary\">\n                <Summary />\n              </Route>\n            </Switch>\n          </div>\n        </div>\n      </Router>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport 'bootstrap/dist/css/bootstrap.min.css'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}